% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tr_sens_spec.R
\name{tr_fpr}
\alias{tr_fpr}
\title{Estimate (Counterfactual) False Positive Rate in the Target Population}
\usage{
tr_fpr(
  predictions,
  outcomes,
  treatment,
  source,
  covariates,
  threshold = 0.5,
  treatment_level = 0,
  analysis = c("transport", "joint"),
  estimator = c("dr", "om", "ipw", "naive"),
  selection_model = NULL,
  propensity_model = NULL,
  outcome_model = NULL,
  se_method = c("none", "bootstrap"),
  n_boot = 200,
  conf_level = 0.95,
  stratified_boot = TRUE,
  parallel = FALSE,
  ncores = NULL,
  ...
)
}
\arguments{
\item{predictions}{Numeric vector of model predictions.}

\item{outcomes}{Numeric vector of observed outcomes.}

\item{treatment}{Numeric vector of treatment indicators (0/1).}

\item{source}{Numeric vector of population indicators (1=source/RCT, 0=target).}

\item{covariates}{A matrix or data frame of baseline covariates.}

\item{threshold}{Numeric vector of classification thresholds. Predictions
above this value are classified as positive. Can be a single value or
a vector for computing sensitivity at multiple thresholds simultaneously.
Default is 0.5.}

\item{treatment_level}{The treatment level of interest (default: 0).}

\item{analysis}{Character string specifying the type of analysis:
\itemize{
\item \code{"transport"}: Use source outcomes for target estimation (default)
\item \code{"joint"}: Pool source and target data
}}

\item{estimator}{Character string specifying the estimator:
\itemize{
\item \code{"naive"}: Naive estimator (biased)
\item \code{"om"}: Outcome model estimator
\item \code{"ipw"}: Inverse probability weighting estimator
\item \code{"dr"}: Doubly robust estimator (default)
}}

\item{selection_model}{Optional fitted selection model for P(S=0|X). If NULL,
a logistic regression model is fit using the covariates.}

\item{propensity_model}{Optional fitted propensity score model for P(A=1|X,S=1).
If NULL, a logistic regression model is fit using source data.}

\item{outcome_model}{Optional fitted outcome model for E[L(Y,g)|X,A,S].
If NULL, a regression model is fit using the relevant data.}

\item{se_method}{Method for standard error estimation:
\itemize{
\item \code{"bootstrap"}: Bootstrap standard errors (default)
\item \code{"influence"}: Influence function-based standard errors
\item \code{"none"}: No standard error estimation
}}

\item{n_boot}{Number of bootstrap replications (default: 500).}

\item{conf_level}{Confidence level for intervals (default: 0.95).}

\item{stratified_boot}{Logical indicating whether to use stratified bootstrap
that preserves the source/target ratio (default: TRUE). Recommended for
transportability analysis.}

\item{parallel}{Logical indicating whether to use parallel processing
for bootstrap (default: FALSE).}

\item{ncores}{Number of cores for parallel processing (default: NULL,
which uses all available cores minus one).}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
An object of class \code{c("tr_fpr", "tr_performance")} with the same
structure as \code{\link[=tr_specificity]{tr_specificity()}}, but with \code{estimate} containing 1 - specificity.
}
\description{
Estimates the false positive rate (1 - specificity) of a binary classifier.
This is a convenience wrapper around \code{\link[=tr_specificity]{tr_specificity()}}.
}
\examples{
set.seed(123)
n <- 500
x <- rnorm(n)
s <- rbinom(n, 1, 0.6)
a <- rbinom(n, 1, 0.5)
y <- rbinom(n, 1, plogis(-1 + x))
pred <- plogis(-1 + 0.8 * x)

result <- tr_fpr(
  predictions = pred, outcomes = y, treatment = a,
  source = s, covariates = data.frame(x = x),
  se_method = "none"
)
print(result)
}
\seealso{
\code{\link[=tr_specificity]{tr_specificity()}}, \code{\link[=tr_sensitivity]{tr_sensitivity()}}
}
