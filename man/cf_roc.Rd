% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/roc.R
\name{cf_roc}
\alias{cf_roc}
\title{Compute Counterfactual ROC Curve}
\usage{
cf_roc(
  predictions,
  outcomes,
  treatment,
  covariates,
  treatment_level = 0,
  estimator = c("dr", "cl", "ipw", "naive"),
  propensity_model = NULL,
  outcome_model = NULL,
  n_thresholds = 201,
  thresholds = NULL,
  include_naive = TRUE,
  ...
)
}
\arguments{
\item{predictions}{Numeric vector of model predictions.}

\item{outcomes}{Numeric vector of observed outcomes.}

\item{treatment}{Numeric vector of treatment indicators (0/1).}

\item{covariates}{A matrix or data frame of baseline covariates (confounders).}

\item{treatment_level}{The counterfactual treatment level (default: 0).}

\item{estimator}{Character string specifying the estimator:
\itemize{
\item \code{"naive"}: Naive estimator (biased)
\item \code{"cl"}: Conditional loss estimator
\item \code{"ipw"}: Inverse probability weighting estimator
\item \code{"dr"}: Doubly robust estimator (default)
}}

\item{propensity_model}{Optional fitted propensity score model. If NULL,
a logistic regression model is fit using the covariates.}

\item{outcome_model}{Optional fitted outcome model. If NULL, a logistic
regression model is fit using the covariates among treated/untreated.}

\item{n_thresholds}{Integer specifying the number of thresholds to evaluate.
Thresholds are evenly spaced between 0 and 1. Default is 201.}

\item{thresholds}{Optional numeric vector of specific thresholds to use.
If provided, overrides \code{n_thresholds}.}

\item{include_naive}{Logical indicating whether to also compute the naive
ROC curve for comparison. Default is TRUE.}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
An object of class \code{c("cf_roc", "roc_curve")} containing:
\item{thresholds}{Thresholds used}
\item{sensitivity}{Sensitivity (TPR) at each threshold}
\item{fpr}{False positive rate at each threshold}
\item{specificity}{Specificity at each threshold}
\item{naive_sensitivity}{Naive sensitivity (if include_naive=TRUE)}
\item{naive_fpr}{Naive FPR (if include_naive=TRUE)}
\item{auc}{Area under the ROC curve (computed via trapezoidal rule)}
\item{naive_auc}{Naive AUC (if include_naive=TRUE)}
\item{estimator}{Estimator used}
\item{n_obs}{Number of observations}
}
\description{
Computes a receiver operating characteristic (ROC) curve under a
hypothetical intervention where treatment is set to a specific level.
}
\details{
The ROC curve plots sensitivity (true positive rate) against the false
positive rate (1 - specificity) at various classification thresholds.

This function computes counterfactual sensitivity and FPR at multiple
thresholds using the estimators from \code{\link[=cf_sensitivity]{cf_sensitivity()}} and \code{\link[=cf_fpr]{cf_fpr()}}.
The area under the curve (AUC) is computed using the trapezoidal rule on
the discrete threshold grid. For exact AUC estimation, use \code{\link[=cf_auc]{cf_auc()}}
which employs the Wilcoxon-Mann-Whitney statistic.
}
\examples{
# Generate example data
set.seed(123)
n <- 500
x <- rnorm(n)
a <- rbinom(n, 1, plogis(-0.5 + 0.5 * x))
y <- rbinom(n, 1, plogis(-1 + x - 0.5 * a))
pred <- plogis(-1 + 0.8 * x)

# Compute counterfactual ROC curve
roc <- cf_roc(
  predictions = pred,
  outcomes = y,
  treatment = a,
  covariates = data.frame(x = x),
  n_thresholds = 51
)
print(roc)

# Plot the ROC curve
plot(roc)
}
\references{
Coston, A., Mishler, A., Kennedy, E. H., & Chouldechova, A. (2020).
"Counterfactual risk assessments, evaluation, and fairness."
\emph{Proceedings of the 2020 Conference on Fairness, Accountability, and
Transparency}, 582-593.
}
\seealso{
\code{\link[=cf_sensitivity]{cf_sensitivity()}}, \code{\link[=cf_specificity]{cf_specificity()}}, \code{\link[=cf_fpr]{cf_fpr()}}, \code{\link[=plot.cf_roc]{plot.cf_roc()}}, \code{\link[=cf_auc]{cf_auc()}}
}
