% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nuisance.R
\name{fit_nuisance}
\alias{fit_nuisance}
\title{Fit Nuisance Models for Counterfactual Performance Estimation}
\usage{
fit_nuisance(
  propensity_formula,
  outcome_formula,
  data,
  treatment_level = 0,
  propensity_method = c("glm", "gam"),
  outcome_method = c("glm", "gam"),
  ...
)
}
\arguments{
\item{propensity_formula}{Formula for the propensity score model.}

\item{outcome_formula}{Formula for the outcome model.}

\item{data}{Data frame containing the variables.}

\item{treatment_level}{The counterfactual treatment level (default: 0).}

\item{propensity_method}{Method for propensity score estimation:
\itemize{
\item \code{"glm"}: Logistic regression (default)
\item \code{"gam"}: Generalized additive model (requires mgcv)
}}

\item{outcome_method}{Method for outcome model estimation:
\itemize{
\item \code{"glm"}: Logistic regression (default)
\item \code{"gam"}: Generalized additive model (requires mgcv)
}}

\item{...}{Additional arguments passed to model fitting functions.}
}
\value{
An object of class \code{cf_nuisance} containing:
\item{propensity}{Fitted propensity score model}
\item{outcome}{Fitted outcome model}
\item{treatment_level}{Counterfactual treatment level}
}
\description{
Fits propensity score and outcome models for use in counterfactual
performance estimation.
}
\details{
This function provides a convenient way to fit nuisance models that can
then be passed to \code{\link[=cf_mse]{cf_mse()}}, \code{\link[=cf_auc]{cf_auc()}}, or \code{\link[=cf_calibration]{cf_calibration()}}.

For the outcome model, only observations with the counterfactual treatment
level are used for fitting, as required for the conditional loss estimator.
}
\examples{
# Generate example data
set.seed(123)
n <- 500
df <- data.frame(
  x1 = rnorm(n),
  x2 = rnorm(n)
)
df$a <- rbinom(n, 1, plogis(-0.5 + 0.5 * df$x1))
df$y <- rbinom(n, 1, plogis(-1 + df$x1 + 0.5 * df$x2 - 0.5 * df$a))

# Fit nuisance models
nuisance <- fit_nuisance(
  propensity_formula = a ~ x1 + x2,
  outcome_formula = y ~ x1 + x2,
  data = df,
  treatment_level = 0
)

print(nuisance)
}
\seealso{
\code{\link[=cf_mse]{cf_mse()}}, \code{\link[=cf_auc]{cf_auc()}}, \code{\link[=cf_calibration]{cf_calibration()}}
}
